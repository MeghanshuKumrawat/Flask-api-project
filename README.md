
# Flask API Project

This project performs various operations on MongoDB Atlas using Flask API.

## Use cases

- Populate database of sample data.
- Add books to the database.
- Issued a book.
- Return a book.
- Add new user.
- Calculate rent of books

## Tech Stack

**Libraries:** flask, flask_mongoengine, mongoengine, pandas

**Database:** MongoDB Atlas


## Table Structure

#### User table :
| Parameter | Type     | Description                |
| :-------- | :------- | :------------------------- |
| `name` | `string` | **Required** |
| `email` | `string` | **Required** |
| `password` | `string` | **Required** |

#### Book table :
| Parameter | Type     | Description                |
| :-------- | :------- | :------------------------- |
| `name` | `string` | **Required** |
| `category` | `string` | **Required** |
| `rent` | `string` | **Required** |

#### Transaction table :
| Parameter | Type     | Description                |
| :-------- | :------- | :------------------------- |
| `user` | `id` | **Required** |
| `book` | `id` | **Required** |
| `issued_date` | `string` | **Required** |
| `return_date` | `string` | **Required** |
| `total_rent` | `int` | **Required** |


## Run Locally

Clone the project

```bash
  git clone https://github.com/MeghanshuKumrawat/Flask-api-project.git
```

Go to the project directory

```bash
  cd Flask-api-project
```

Install dependencies

```bash
  pip install -r requirements.txt
```
- Create account on MongoDB Atlas
- Create Free cluster
- Get the connection URI
- Open app.py and paste URL (host key)

```bash
  pip install -r requirements.txt
```

Start the server

```bash
  python wsgi.py
```


## API Reference

#### Populate the database using sample data

```http
  GET http://localhost:5000/api/v1/db-populate
```

#### Create user

```http
  POST http://localhost:5000/api/v1/user/create-user
```

| Parameter | Type     | Description                |
| :-------- | :------- | :------------------------- |
| `name` | `string` | **Required** |
| `email` | `string` | **Required** |
| `password` | `string` | **Required** |

#### Get list of all the books with that name or term in the book name

```http
  GET http://localhost:5000/api/v1/book/book-search
```

| Parameter | Type     | Description                |
| :-------- | :------- | :------------------------- |
| `book` | `string` | **Required** |

#### Get list of books with rent in that range

```http
  GET http://localhost:5000/api/v1/book/book-price-range
```

| Parameter | Type     | Description                       |
| :-------- | :------- | :-------------------------------- |
| `price_range`| `string` | **Required** |

#### Get list of books with matching values as in input

```http
  GET http://localhost:5000/api/v1/book/filter-book
```

| Parameter | Type     | Description                       |
| :-------- | :------- | :-------------------------------- |
| `title`| `string` | **Required** |
| `category`| `string` | **Required** |
| `price_range`| `string` | **Required** |


#### Update the Transaction DB with these values (BOOK IS ISSUED)

```http
  GET http://localhost:5000/api/v1/transaction/issue-book
```

| Parameter | Type     | Description                       |
| :-------- | :------- | :-------------------------------- |
| `username`| `string` | **Required** |
| `book`| `string` | **Required** |
| `date`| `string` | **Required** |

#### Calculate rent based on issue date and return date and update the Transaction DB with these values. (BOOK IS RETURNED)

```http
  GET http://localhost:5000/api/v1/transaction/return-book
```

| Parameter | Type     | Description                       |
| :-------- | :------- | :-------------------------------- |
| `username`| `string` | **Required** |
| `book`| `string` | **Required** |
| `date`| `string` | **Required** |

#### Get List of people who have issued that book ( total count) + list of people who currently have that book issued ( currently issued only).

```http
  GET http://localhost:5000/api/v1/transaction/get-users-by-book
```

| Parameter | Type     | Description                       |
| :-------- | :------- | :-------------------------------- |
| `book`| `string` | **Required** |

#### Get total rent generated by that book
```http
  GET http://localhost:5000/api/v1/transaction/get-total-rent-by-book
```

| Parameter | Type     | Description                       |
| :-------- | :------- | :-------------------------------- |
| `book`| `string` | **Required** |

#### Get list of books issued to that person
```http
  GET http://localhost:5000/api/v1/transaction/get-books-by-user
```

| Parameter | Type     | Description                       |
| :-------- | :------- | :-------------------------------- |
| `username`| `string` | **Required** |

#### Get list of books issued in that date range and the person they are issued to
```http
  GET http://localhost:5000/api/v1/transaction/date-range-transaction
```

| Parameter | Type     | Description                       |
| :-------- | :------- | :-------------------------------- |
| `start`| `string` | **Required** |
| `end`| `string` | **Required** |

